(function(){var y=function(a,b,d,f){var c=b.moment?b.moment:b.dayjs?b.dayjs:null,e=function(b,d){this.c=a.extend(!0,{},e.defaults,d);var f=this.c.classPrefix,p=this.c.i18n;if(!c&&"YYYY-MM-DD"!==this.c.format)throw"DateTime: Without momentjs or dayjs only the format 'YYYY-MM-DD' can be used";"string"===typeof this.c.minDate&&(this.c.minDate=new Date(this.c.minDate));"string"===typeof this.c.maxDate&&(this.c.maxDate=new Date(this.c.maxDate));p=a('<div class="'+f+'"><div class="'+f+'-date"><div class="'+
f+'-title"><div class="'+f+'-iconLeft"><button>'+p.previous+'</button></div><div class="'+f+'-iconRight"><button>'+p.next+'</button></div><div class="'+f+'-label"><span></span><select class="'+f+'-month"></select></div><div class="'+f+'-label"><span></span><select class="'+f+'-year"></select></div></div><div class="'+f+'-calendar"></div></div><div class="'+f+'-time"><div class="'+f+'-hours"></div><div class="'+f+'-minutes"></div><div class="'+f+'-seconds"></div></div><div class="'+f+'-error"></div></div>');
this.dom={container:p,date:p.find("."+f+"-date"),title:p.find("."+f+"-title"),calendar:p.find("."+f+"-calendar"),time:p.find("."+f+"-time"),error:p.find("."+f+"-error"),input:a(b)};this.s={d:null,display:null,minutesRange:null,secondsRange:null,namespace:"dateime-"+e._instance++,parts:{date:null!==this.c.format.match(/[YMD]|L(?!T)|l/),time:null!==this.c.format.match(/[Hhm]|LT|LTS/),seconds:-1!==this.c.format.indexOf("s"),hours12:null!==this.c.format.match(/[haA]/)}};this.dom.container.append(this.dom.date).append(this.dom.time).append(this.dom.error);
this.dom.date.append(this.dom.title).append(this.dom.calendar);this._constructor()};a.extend(e.prototype,{destroy:function(){this._hide();this.dom.container.off().empty();this.dom.input.off(".datetime")},errorMsg:function(a){var b=this.dom.error;a?b.html(a):b.empty();return this},hide:function(){this._hide();return this},max:function(a){this.c.maxDate="string"===typeof a?new Date(a):a;this._optionsTitle();this._setCalander();return this},min:function(a){this.c.minDate="string"===typeof a?new Date(a):
a;this._optionsTitle();this._setCalander();return this},owns:function(b){return 0<a(b).parents().filter(this.dom.container).length},val:function(a,b){if(a===f)return this.s.d;if(a instanceof Date)this.s.d=this._dateToUtc(a);else if(null===a||""===a)this.s.d=null;else if("--now"===a)this.s.d=new Date;else if("string"===typeof a)if(c){var d=c.utc(a,this.c.format,this.c.locale,this.c.strict);this.s.d=d.isValid()?d.toDate():null}else d=a.match(/(\d{4})\-(\d{2})\-(\d{2})/),this.s.d=d?new Date(Date.UTC(d[1],
d[2]-1,d[3])):null;if(b||b===f)this.s.d?this._writeOutput():this.dom.input.val(a);this.s.d||(this.s.d=this._dateToUtc(new Date));this.s.display=new Date(this.s.d.toString());this.s.display.setUTCDate(1);this._setTitle();this._setCalander();this._setTime();return this},_constructor:function(){var b=this,d=this.c.classPrefix,f=function(){b.c.onChange.call(b,b.dom.input.val(),b.s.d,b.dom.input)};this.s.parts.date||this.dom.date.css("display","none");this.s.parts.time||this.dom.time.css("display","none");
this.s.parts.seconds||(this.dom.time.children("div."+d+"-seconds").remove(),this.dom.time.children("span").eq(1).remove());this._optionsTitle();this.dom.input.attr("autocomplete","off").on("focus.datetime click.datetime",function(){if(!b.dom.container.is(":visible")&&!b.dom.input.is(":disabled")){b.val(b.dom.input.val(),false);b._show()}}).on("keyup.datetime",function(){b.dom.container.is(":visible")&&b.val(b.dom.input.val(),false)});this.dom.container.on("change","select",function(){var e=a(this),
c=e.val();if(e.hasClass(d+"-month")){b._correctMonth(b.s.display,c);b._setTitle();b._setCalander()}else if(e.hasClass(d+"-year")){b.s.display.setUTCFullYear(c);b._setTitle();b._setCalander()}else if(e.hasClass(d+"-hours")||e.hasClass(d+"-ampm")){if(b.s.parts.hours12){e=a(b.dom.container).find("."+d+"-hours").val()*1;c=a(b.dom.container).find("."+d+"-ampm").val()==="pm";b.s.d.setUTCHours(e===12&&!c?0:c&&e!==12?e+12:e)}else b.s.d.setUTCHours(c);b._setTime();b._writeOutput(true);f()}else if(e.hasClass(d+
"-minutes")){b.s.d.setUTCMinutes(c);b._setTime();b._writeOutput(true);f()}else if(e.hasClass(d+"-seconds")){b.s.d.setSeconds(c);b._setTime();b._writeOutput(true);f()}b.dom.input.focus();b._position()}).on("click",function(e){var c=b.s.d,n=e.target.nodeName.toLowerCase(),i=n==="span"?e.target.parentNode:e.target,n=i.nodeName.toLowerCase();if(n!=="select"){e.stopPropagation();if(n==="button"){i=a(i);e=i.parent();if(e.hasClass("disabled")&&!e.hasClass("range"))i.blur();else if(e.hasClass(d+"-iconLeft")){b.s.display.setUTCMonth(b.s.display.getUTCMonth()-
1);b._setTitle();b._setCalander();b.dom.input.focus()}else if(e.hasClass(d+"-iconRight")){b._correctMonth(b.s.display,b.s.display.getUTCMonth()+1);b._setTitle();b._setCalander();b.dom.input.focus()}else{if(i.parents("."+d+"-time").length){n=i.data("value");i=i.data("unit");if(i==="minutes"){if(e.hasClass("disabled")&&e.hasClass("range")){b.s.minutesRange=n;b._setTime();return}b.s.minutesRange=null}if(i==="seconds"){if(e.hasClass("disabled")&&e.hasClass("range")){b.s.secondsRange=n;b._setTime();return}b.s.secondsRange=
null}if(n==="am")if(c.getUTCHours()>=12)n=c.getUTCHours()-12;else return;else if(n==="pm")if(c.getUTCHours()<12)n=c.getUTCHours()+12;else return;c[i==="hours"?"setUTCHours":i==="minutes"?"setUTCMinutes":"setSeconds"](n);b._setTime();b._writeOutput(true)}else{c||(c=b._dateToUtc(new Date));c.setUTCDate(1);c.setUTCFullYear(i.data("year"));c.setUTCMonth(i.data("month"));c.setUTCDate(i.data("day"));b._writeOutput(true);b.s.parts.time?b._setCalander():setTimeout(function(){b._hide()},10)}f()}}else b.dom.input.focus()}})},
_compareDates:function(a,b){return this._dateToUtcString(a)===this._dateToUtcString(b)},_correctMonth:function(a,b){var d=this._daysInMonth(a.getUTCFullYear(),b),f=a.getUTCDate()>d;a.setUTCMonth(b);f&&(a.setUTCDate(d),a.setUTCMonth(b))},_daysInMonth:function(a,b){return[31,0===a%4&&(0!==a%100||0===a%400)?29:28,31,30,31,30,31,31,30,31,30,31][b]},_dateToUtc:function(a){return new Date(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds()))},_dateToUtcString:function(a){return a.getUTCFullYear()+
"-"+this._pad(a.getUTCMonth()+1)+"-"+this._pad(a.getUTCDate())},_hide:function(){var f=this.s.namespace;this.dom.container.detach();a(b).off("."+f);a(d).off("keydown."+f);a("div.dataTables_scrollBody").off("scroll."+f);a("div.DTE_Body_Content").off("scroll."+f);a("body").off("click."+f)},_hours24To12:function(a){return 0===a?12:12<a?a-12:a},_htmlDay:function(a){if(a.empty)return'<td class="empty"></td>';var b=["selectable"],d=this.c.classPrefix;a.disabled&&b.push("disabled");a.today&&b.push("now");
a.selected&&b.push("selected");return'<td data-day="'+a.day+'" class="'+b.join(" ")+'"><button class="'+d+"-button "+d+'-day" type="button" data-year="'+a.year+'" data-month="'+a.month+'" data-day="'+a.day+'"><span>'+a.day+"</span></button></td>"},_htmlMonth:function(b,d){var f=this._dateToUtc(new Date),e=this._daysInMonth(b,d),c=(new Date(Date.UTC(b,d,1))).getUTCDay(),n=[],i=[];0<this.c.firstDay&&(c-=this.c.firstDay,0>c&&(c+=7));for(var g=e+c,h=g;7<h;)h-=7;var g=g+(7-h),j=this.c.minDate,h=this.c.maxDate;
j&&(j.setUTCHours(0),j.setUTCMinutes(0),j.setSeconds(0));h&&(h.setUTCHours(23),h.setUTCMinutes(59),h.setSeconds(59));for(var m=0,k=0;m<g;m++){var l=new Date(Date.UTC(b,d,1+(m-c))),o=this.s.d?this._compareDates(l,this.s.d):!1,A=this._compareDates(l,f),r=m<c||m>=e+c,x=j&&l<j||h&&l>h,u=this.c.disableDays;a.isArray(u)&&-1!==a.inArray(l.getUTCDay(),u)?x=!0:"function"===typeof u&&!0===u(l)&&(x=!0);i.push(this._htmlDay({day:1+(m-c),month:d,year:b,selected:o,today:A,disabled:x,empty:r}));7===++k&&(this.c.showWeekNumber&&
i.unshift(this._htmlWeekOfYear(m-c,d,b)),n.push("<tr>"+i.join("")+"</tr>"),i=[],k=0)}f=this.c.classPrefix;e=f+"-table";this.c.showWeekNumber&&(e+=" weekNumber");j&&(j=j>=new Date(Date.UTC(b,d,1,0,0,0)),this.dom.title.find("div."+f+"-iconLeft").css("display",j?"none":"block"));h&&(h=h<new Date(Date.UTC(b,d+1,1,0,0,0)),this.dom.title.find("div."+f+"-iconRight").css("display",h?"none":"block"));return'<table class="'+e+'"><thead>'+this._htmlMonthHead()+"</thead><tbody>"+n.join("")+"</tbody></table>"},
_htmlMonthHead:function(){var a=[],b=this.c.firstDay,d=this.c.i18n,f=function(a){for(a+=b;7<=a;)a-=7;return d.weekdays[a]};this.c.showWeekNumber&&a.push("<th></th>");for(var e=0;7>e;e++)a.push("<th>"+f(e)+"</th>");return a.join("")},_htmlWeekOfYear:function(a,b,d){a=new Date(d,b,a,0,0,0,0);a.setDate(a.getDate()+4-(a.getDay()||7));d=Math.ceil(((a-new Date(d,0,1))/864E5+1)/7);return'<td class="'+this.c.classPrefix+'-week">'+d+"</td>"},_options:function(a,b,d){d||(d=b);a=this.dom.container.find("select."+
this.c.classPrefix+"-"+a);a.empty();for(var f=0,e=b.length;f<e;f++)a.append('<option value="'+b[f]+'">'+d[f]+"</option>")},_optionSet:function(a,b){var d=this.dom.container.find("select."+this.c.classPrefix+"-"+a),f=d.parent().children("span");d.val(b);d=d.find("option:selected");f.html(0!==d.length?d.text():this.c.i18n.unknown)},_optionsTime:function(b,d,f,e,c){var n=this.c.classPrefix,i=this.dom.container.find("div."+n+"-"+b),g,h=12===d?function(a){return a}:this._pad,n=this.c.classPrefix,j=n+"-table",
m=this.c.i18n;if(i.length){var k="";g=10;var l=function(c,i,g){12===d&&(12<=f&&"number"===typeof c)&&(c+=12);var h=f===c||"am"===c&&12>f||"pm"===c&&12<=f?"selected":"";e&&-1===a.inArray(c,e)&&(h+=" disabled");g&&(h+=" "+g);return'<td class="selectable '+h+'"><button class="'+n+"-button "+n+'-day" type="button" data-unit="'+b+'" data-value="'+c+'"><span>'+i+"</span></button></td>"};if(12===d){k+="<tr>";for(c=1;6>=c;c++)k+=l(c,h(c));k+=l("am",m.amPm[0]);k+="</tr><tr>";for(c=7;12>=c;c++)k+=l(c,h(c));
k+=l("pm",m.amPm[1]);k+="</tr>";g=7}else{if(24===d){var o=0;for(g=0;4>g;g++){k+="<tr>";for(c=0;6>c;c++)k+=l(o,h(o)),o++;k+="</tr>"}}else{k+="<tr>";for(g=0;60>g;g+=10)k+=l(g,h(g),"range");c=null!==c?c:10*Math.floor(f/10);k=k+"</tr>"+('</tbody></thead><table class="'+j+" "+j+'-nospace"><tbody>')+"<tr>";for(g=c+1;g<c+10;g++)k+=l(g,h(g));k+="</tr>"}g=6}i.empty().append('<table class="'+j+'"><thead><tr><th colspan="'+g+'">'+m[b]+"</th></tr></thead><tbody>"+k+"</tbody></table>")}},_optionsTitle:function(){var a=
this.c.i18n,b=this.c.minDate,d=this.c.maxDate,b=b?b.getFullYear():null,d=d?d.getFullYear():null,b=null!==b?b:(new Date).getFullYear()-this.c.yearRange,d=null!==d?d:(new Date).getFullYear()+this.c.yearRange;this._options("month",this._range(0,11),a.months);this._options("year",this._range(b,d))},_pad:function(a){return 10>a?"0"+a:a},_position:function(){var d="input"===this.c.attachTo?this.dom.input.position():this.dom.input.offset(),f=this.dom.container,c=this.dom.input.outerHeight();this.s.parts.date&&
this.s.parts.time&&550<a(b).width()?f.addClass("horizontal"):f.removeClass("horizontal");"input"===this.c.attachTo?f.css({top:d.top+c,left:d.left}).insertAfter(this.dom.input):f.css({top:d.top+c,left:d.left}).appendTo("body");var e=f.outerHeight(),n=f.outerWidth(),i=a(b).scrollTop();d.top+c+e-i>a(b).height()&&(c=d.top-e,f.css("top",0>c?0:c));n+d.left>a(b).width()&&(d=a(b).width()-n,f.css("left",0>d?0:d))},_range:function(a,b,d){var f=[];for(d||(d=1);a<=b;a+=d)f.push(a);return f},_setCalander:function(){this.s.display&&
this.dom.calendar.empty().append(this._htmlMonth(this.s.display.getUTCFullYear(),this.s.display.getUTCMonth()))},_setTitle:function(){this._optionSet("month",this.s.display.getUTCMonth());this._optionSet("year",this.s.display.getUTCFullYear())},_setTime:function(){var a=this,b=this.s.d,d=b?b.getUTCHours():0,f=function(b){return a.c[b+"Available"]?a.c[b+"Available"]:a._range(0,59,a.c[b+"Increment"])};this._optionsTime("hours",this.s.parts.hours12?12:24,d,this.c.hoursAvailable);this._optionsTime("minutes",
60,b?b.getUTCMinutes():0,f("minutes"),this.s.minutesRange);this._optionsTime("seconds",60,b?b.getSeconds():0,f("seconds"),this.s.secondsRange)},_show:function(){var f=this,c=this.s.namespace;this._position();a(b).on("scroll."+c+" resize."+c,function(){f._hide()});a("div.DTE_Body_Content").on("scroll."+c,function(){f._hide()});a("div.dataTables_scrollBody").on("scroll."+c,function(){f._hide()});var e=this.dom.input[0].offsetParent;if(e!==d.body)a(e).on("scroll."+c,function(){f._hide()});a(d).on("keydown."+
c,function(a){(9===a.keyCode||27===a.keyCode||13===a.keyCode)&&f._hide()});setTimeout(function(){a("body").on("click."+c,function(b){!a(b.target).parents().filter(f.dom.container).length&&b.target!==f.dom.input[0]&&f._hide()})},10)},_writeOutput:function(a){var b=this.s.d,d=c?c.utc(b,f,this.c.locale,this.c.strict).format(this.c.format):b.getUTCFullYear()+"-"+this._pad(b.getUTCMonth()+1)+"-"+this._pad(b.getUTCDate());this.dom.input.val(d).trigger("change",{write:b});a&&this.dom.input.focus()}});e.use=
function(a){c=a};e._instance=0;e.defaults={attachTo:"body",classPrefix:"dt-datetime",disableDays:null,firstDay:1,format:"YYYY-MM-DD",hoursAvailable:null,i18n:{previous:"Previous",next:"Next",months:"January February March April May June July August September October November December".split(" "),weekdays:"Sun Mon Tue Wed Thu Fri Sat".split(" "),amPm:["am","pm"],hours:"Hour",minutes:"Minute",seconds:"Second",unknown:"-"},maxDate:null,minDate:null,minutesAvailable:null,minutesIncrement:1,strict:!0,
locale:"en",onChange:function(){},secondsAvailable:null,secondsIncrement:1,showWeekNumber:!1,yearRange:25};b.DateTime||(b.DateTime=e);a.fn.dtDateTime=function(a){return this.each(function(){new e(this,a)})};a.dataTable&&(a.dataTable.DateTime=e,a.DataTable.DateTime=e);return e};"function"===typeof define&&define.amd?define(["jquery"],function(a){return y(a,window,document)}):"object"===typeof exports?module.exports=function(a,b){a||(a=window);return y(b,a,a.document)}:y(jQuery,window,document);var e,
r,l=window.moment,o,c=function(a,b,d,f,n){var i=this;void 0===f&&(f=0);void 0===n&&(n=1);if(!r||!r.versionCheck||!r.versionCheck("1.10.0"))throw Error("SearchPane requires DataTables 1.10 or newer");this.classes=e.extend(!0,{},c.classes);this.c=e.extend(!0,{},c.defaults,e.fn.dataTable.ext.searchBuilder,b);this.s={condition:void 0,conditions:new Map,data:void 0,dataIdx:-1,dataPoints:[],depth:n,dt:a,filled:!1,index:f,momentFormat:!1,topGroup:d,type:"",value:[]};this.dom={buttons:e("<div/>").addClass(this.classes.buttonContainer),
condition:e("<select disabled/>").addClass(this.classes.condition).addClass(this.classes.dropDown).addClass(this.classes.italic),conditionTitle:e('<option value="" disabled selected hidden/>').text(this.s.dt.i18n("searchBuilder.condition","Condition")),container:e("<div/>").addClass(this.classes.container),data:e("<select/>").addClass(this.classes.data).addClass(this.classes.dropDown).addClass(this.classes.italic),dataTitle:e('<option value="" disabled selected hidden/>').text(this.s.dt.i18n("searchBuilder.data",
"Data")),defaultValue:e("<select disabled/>").addClass(this.classes.value).addClass(this.classes.dropDown),"delete":e("<button>&times</button>").addClass(this.classes["delete"]).addClass(this.classes.button).attr("title",this.s.dt.i18n("searchBuilder.deleteTitle","Delete filtering rule")),left:e("<button><</button>").addClass(this.classes.left).addClass(this.classes.button).attr("title",this.s.dt.i18n("searchBuilder.leftTitle","Outdent criteria")),right:e("<button>></button>").addClass(this.classes.right).addClass(this.classes.button).attr("title",
this.s.dt.i18n("searchBuilder.rightTitle","Indent criteria")),value:[e("<select disabled/>").addClass(this.classes.value).addClass(this.classes.dropDown).addClass(this.classes.italic)],valueTitle:e('<option value="" disabled selected hidden/>').text(this.s.dt.i18n("searchBuilder.value","Value"))};if(this.c.greyscale){e(this.dom.data).addClass(this.classes.greyscale);e(this.dom.condition).addClass(this.classes.greyscale);a=0;for(b=this.dom.value;a<b.length;a++)e(b[a]).addClass(this.classes.greyscale)}this.s.dt.on("draw.dtsp",
function(){i._adjustCriteria()});this.s.dt.on("buttons-action",function(){i._adjustCriteria()});e(window).on("resize.dtsp",r.util.throttle(function(){i._adjustCriteria()}));this._buildCriteria();return this};c.prototype.updateArrows=function(a,b){void 0===a&&(a=!1);void 0===b&&(b=!0);e(this.dom.container).empty().append(this.dom.data).append(this.dom.condition).append(this.dom.value[0]);e(this.dom.value[0]).trigger("dtsb-inserted");for(var d=1;d<this.dom.value.length;d++)e(this.dom.container).append(this.dom.value[d]),
e(this.dom.value[d]).trigger("dtsb-inserted");1<this.s.depth&&e(this.dom.buttons).append(this.dom.left);(!1===this.c.depthLimit||this.s.depth<this.c.depthLimit)&&a&&e(this.dom.buttons).append(this.dom.right);e(this.dom.buttons).append(this.dom["delete"]);e(this.dom.container).append(this.dom.buttons);b&&this._adjustCriteria()};c.prototype.destroy=function(){e(this.dom.data).off(".dtsb");e(this.dom.condition).off(".dtsb");e(this.dom["delete"]).off(".dtsb");for(var a=0,b=this.dom.value;a<b.length;a++)e(b[a]).off(".dtsb");
e(this.dom.container).remove()};c.prototype.search=function(a){var b=this.s.conditions.get(this.s.condition);if(void 0!==this.s.condition&&void 0!==b)return b.search(a[this.s.dataIdx],this.s.value,this)};c.prototype.getDetails=function(){return{condition:this.s.condition,data:this.s.data,value:this.s.value}};c.prototype.getNode=function(){return this.dom.container};c.prototype.populate=function(){this._populateData();-1!==this.s.dataIdx&&(this._populateCondition(),void 0!==this.s.condition&&this._populateValue())};
c.prototype.rebuild=function(a){var b=!1,d;this._populateData();if(void 0!==a.data){var f=this.classes.italic,c=this.dom.data;e(this.dom.data).children("option").each(function(){e(this).text()===a.data&&(e(this).attr("selected",!0),e(c).removeClass(f),b=!0,d=e(this).val())})}if(b){this.s.data=a.data;this.s.dataIdx=d;e(this.dom.dataTitle).remove();this._populateCondition();e(this.dom.conditionTitle).remove();var i;e(this.dom.condition).children("option").each(function(){void 0!==a.condition&&(e(this).val()===
a.condition&&"string"===typeof a.condition)&&(e(this).attr("selected",!0),i=e(this).val())});this.s.condition=i;void 0!==this.s.condition?(e(this.dom.conditionTitle).remove(),e(this.dom.condition).removeClass(this.classes.italic),this._populateValue(a)):e(this.dom.conditionTitle).prependTo(this.dom.condition).attr("selected",!0)}};c.prototype.setListeners=function(){var a=this;e(this.dom.data).unbind("input").on("input",function(){e(a.dom.dataTitle).attr("selected",!1);e(a.dom.data).removeClass(a.classes.italic);
a.s.dataIdx=e(a.dom.data).children("option:selected").val();a.s.data=e(a.dom.data).children("option:selected").text();a._clearCondition();a._clearValue();a._populateCondition();a.s.filled&&(a.s.filled=!1,a.s.dt.draw(),a.setListeners());a.s.dt.state.save()});e(this.dom.condition).unbind("input").on("input",function(){e(a.dom.conditionTitle).attr("selected",!1);e(a.dom.condition).removeClass(a.classes.italic);for(var b=e(a.dom.condition).children("option:selected").val(),d=0,f=Array.from(a.s.conditions.keys());d<
f.length;d++)if(f[d]===b){a.s.condition=b;break}a._clearValue();a._populateValue();b=0;for(d=a.dom.value;b<d.length;b++)f=d[b],a.s.filled&&0!==e(a.dom.container).has(f).length&&(a.s.filled=!1,a.s.dt.draw(),a.setListeners());a.s.dt.draw()})};c.prototype._adjustCriteria=function(){if(0!==e(document).has(this.dom.container).length){var a,b;a=this.dom.value[this.dom.value.length-1];if(0!==e(this.dom.container).has(a).length){b=e(a).outerWidth(!0);a=e(a).offset().left+b;var d=e(this.dom.left).offset(),
f=e(this.dom.right).offset(),c=e(this.dom["delete"]).offset(),i=0!==e(this.dom.container).has(this.dom.left).length,g=0!==e(this.dom.container).has(this.dom.right).length,h=i?d.left:g?f.left:c.left;15>h-a||i&&d.top!==c.top||g&&f.top!==c.top?(e(this.dom.container).parent().addClass(this.classes.vertical),e(this.s.topGroup).trigger("dtsb-redrawContents")):15<h-(e(this.dom.data).offset().left+e(this.dom.data).outerWidth(!0)+e(this.dom.condition).outerWidth(!0)+b)&&(e(this.dom.container).parent().removeClass(this.classes.vertical),
e(this.s.topGroup).trigger("dtsb-redrawContents"))}}};c.prototype._buildCriteria=function(){e(this.dom.data).append(this.dom.dataTitle);e(this.dom.condition).append(this.dom.conditionTitle);e(this.dom.container).append(this.dom.data).append(this.dom.condition);for(var a=0,b=this.dom.value;a<b.length;a++){var d=b[a];e(d).append(this.dom.valueTitle);e(this.dom.container).append(d)}e(this.dom.container).append(this.dom["delete"]).append(this.dom.right);this.setListeners()};c.prototype._clearCondition=
function(){e(this.dom.condition).empty();e(this.dom.conditionTitle).attr("selected",!0).attr("disabled",!0);e(this.dom.condition).append(this.dom.conditionTitle);this.s.conditions=new Map;this.s.condition=void 0};c.prototype._clearValue=function(){if(void 0!==this.s.condition){for(var a=0,b=this.dom.value;a<b.length;a++){var d=b[a];e(d).remove()}d=this.s.conditions.get(this.s.condition).init(this,c.updateListener);this.dom.value=Array.isArray(d)?d:[d];e(this.dom.value[0]).insertAfter(this.dom.condition).trigger("dtsb-inserted");
for(d=1;d<this.dom.value.length;d++)e(this.dom.value[d]).insertAfter(this.dom.value[d-1]).trigger("dtsb-inserted")}else{a=0;for(b=this.dom.value;a<b.length;a++)d=b[a],e(d).remove();e(this.dom.valueTitle).attr("selected",!0).attr("disabled",!1);e(this.dom.defaultValue).append(this.dom.valueTitle).insertAfter(this.dom.condition)}this.s.value=[]};c.prototype._populateCondition=function(){var a=[];if(0===this.s.conditions.size){var b=e(this.dom.data).children("option:selected").val();this.s.type=this.s.dt.columns().type().toArray()[b];
null===this.s.type&&(this.s.dt.draw(),this.setListeners(),this.s.type=this.s.dt.columns().type().toArray()[b]);e(this.dom.condition).attr("disabled",!1).empty().append(this.dom.conditionTitle).addClass(this.classes.italic);e(this.dom.conditionTitle).attr("selected",!0);var d=void 0!==this.c.conditions[this.s.type]?this.c.conditions[this.s.type]:-1!==this.s.type.indexOf("moment")&&void 0!==e.fn.dataTable.moment?this.c.conditions.moment:this.c.conditions.string;-1!==this.s.type.indexOf("moment")&&(this.s.momentFormat=
this.s.type.replace(/moment\-/g,""));for(var f=0,c=Object.keys(d);f<c.length;f++)b=c[f],null!==d[b]&&(this.s.conditions.set(b,d[b]),a.push(e("<option>",{text:d[b].conditionName,value:b}).addClass(this.classes.option).addClass(this.classes.notItalic)))}else if(0<this.s.conditions.size){e(this.dom.condition).empty().attr("disabled",!1).addClass(this.classes.italic);d=0;for(f=Array.from(this.s.conditions.keys());d<f.length;d++)b=f[d],c=this.s.conditions.get(b).conditionName,b=e("<option>",{text:c,value:b}).addClass(this.classes.option).addClass(this.classes.notItalic),
void 0!==this.s.condition&&this.s.condition===c&&(e(b).attr("selected",!0),e(this.dom.condition).removeClass(this.classes.italic)),a.push(b)}else{e(this.dom.condition).attr("disabled",!0).addClass(this.classes.italic);return}a.sort(function(a,b){return e(a).val()<e(b).val()?-1:e(a).val()<e(b).val()?1:0});for(b=0;b<a.length;b++)d=a[b],e(this.dom.condition).append(d)};c.prototype._populateData=function(){var a=this;e(this.dom.data).empty().append(this.dom.dataTitle);if(0===this.s.dataPoints.length)this.s.dt.columns().every(function(b){if(!0===
a.c.columns||-1!==a.s.dt.columns(a.c.columns).indexes().toArray().indexOf(b)){for(var d=!1,c=0,f=a.s.dataPoints;c<f.length;c++)if(f[c].index===b){d=!0;break}d||(b={text:a.s.dt.settings()[0].aoColumns[b].sTitle,index:b},a.s.dataPoints.push(b),e(a.dom.data).append(e("<option>",{text:b.text,value:b.index}).addClass(a.classes.option).addClass(a.classes.notItalic)))}});else for(var b=function(b){d.s.dt.columns().every(function(d){a.s.dt.settings()[0].aoColumns[d].sTitle===b.text&&(b.index=d)});var c=e("<option>",
{text:b.text,value:b.index}).addClass(d.classes.option).addClass(d.classes.notItalic);d.s.data===b.text&&(d.s.dataIdx=b.index,e(c).attr("selected",!0),e(d.dom.data).removeClass(d.classes.italic));e(d.dom.data).append(c)},d=this,c=0,g=this.s.dataPoints;c<g.length;c++)b(g[c])};c.prototype._populateValue=function(a){var b=this,d=this.s.filled;this.s.filled=!1;e(this.dom.defaultValue).remove();for(var f=0,g=this.dom.value;f<g.length;f++)e(g[f]).remove();f=e(this.dom.container).children();if(3<f.length)for(g=
2;g<f.length-1;g++)e(f[g]).remove();void 0!==a&&this.s.dt.columns().every(function(d){b.s.dt.settings()[0].aoColumns[d].sTitle===a.data&&(b.s.dataIdx=d)});f=this.s.conditions.get(this.s.condition).init(this,c.updateListener,void 0!==a?a.value:void 0);void 0!==a&&void 0!==a.value&&(this.s.value=a.value);this.dom.value=Array.isArray(f)?f:[f];e(this.dom.value[0]).insertAfter(this.dom.condition).trigger("dtsb-inserted");for(g=1;g<this.dom.value.length;g++)e(this.dom.value[g]).insertAfter(this.dom.value[g-
1]).trigger("dtsb-inserted");this.s.filled=this.s.conditions.get(this.s.condition).isInputValid(this.dom.value,this);this.setListeners();d!==this.s.filled&&(this.s.dt.draw(),this.setListeners())};c.version="0.0.1";c.classes={button:"dtsb-button",buttonContainer:"dtsb-buttonContainer",condition:"dtsb-condition",container:"dtsb-criteria",data:"dtsb-data","delete":"dtsb-delete",dropDown:"dtsb-dropDown",greyscale:"dtsb-greyscale",input:"dtsb-input",italic:"dtsb-italic",joiner:"dtsp-joiner",left:"dtsb-left",
notItalic:"dtsb-notItalic",option:"dtsb-option",right:"dtsb-right",value:"dtsb-value",vertical:"dtsb-vertical"};c.initSelect=function(a,b,d){void 0===d&&(d=null);for(var f=e(a.dom.data).children("option:selected").val(),g=a.s.dt.rows().indexes().toArray(),i=a.s.dt.settings()[0],h=e("<select/>").addClass(c.classes.value).addClass(c.classes.dropDown).addClass(c.classes.italic).append(a.dom.valueTitle).on("input",function(){e(this).removeClass(c.classes.italic);b(a,this)}),j=[],l=[],m=0;m<g.length;m++){var o=
g[m],q=i.oApi._fnGetCellData(i,o,f,a.c.orthogonal.search),o=i.oApi._fnGetCellData(i,o,f,"display"),q=e("<option>",{text:a.s.type.includes("html")?o.replace(/(<([^>]+)>)/ig,""):o,value:a.s.type.includes("html")?q.replace(/(<([^>]+)>)/ig,""):q}).addClass(a.classes.option).addClass(a.classes.notItalic),o=e(q).val();-1===j.indexOf(o)&&(j.push(o),l.push(q),null!==d&&q.val()===d[0]&&(q.attr("selected",!0),a.dom.valueTitle.remove(),e(h).removeClass(c.classes.italic)))}l.sort(function(b,d){if("string"===
a.s.type||"num"===a.s.type||"html"===a.s.type||"html-num"===a.s.type)return e(b).val()<e(d).val()?-1:e(b).val()<e(d).val()?1:0;if("num-fmt"===a.s.type||"html-num-fmt"===a.s.type)return+e(b).val().replace(/[^0-9.]/g,"")<+e(d).val().replace(/[^0-9.]/g,"")?-1:+e(b).val().replace(/[^0-9.]/g,"")<+e(d).val().replace(/[^0-9.]/g,"")?1:0});for(d=0;d<l.length;d++)q=l[d],e(h).append(q);return h};c.initInput=function(a,b,d){void 0===d&&(d=null);var f=e("<input/>").addClass(c.classes.value).addClass(c.classes.input).on("input",
function(){b(a,this)});null!==d&&e(f).val(d[0]);return f};c.init2Input=function(a,b,d){void 0===d&&(d=null);var f=[e("<input/>").addClass(c.classes.value).addClass(c.classes.input).on("input",function(){b(a,this)}),e("<span>").addClass(a.classes.joiner).text("and"),e("<input/>").addClass(c.classes.value).addClass(c.classes.input).on("input",function(){b(a,this)})];null!==d&&(e(f[0]).val(d[0]),e(f[2]).val(d[1]));return f};c.initDate=function(a,b,d){void 0===d&&(d=null);var f=e("<input/>").addClass(c.classes.value).addClass(c.classes.input).dtDateTime({attachTo:"input",
format:a.s.momentFormat?a.s.momentFormat:void 0}).on("input change",function(){b(a,this)});null!==d&&e(f).val(d[0]);return f};c.init2Date=function(a,b,d){void 0===d&&(d=null);var f=[e("<input/>").addClass(c.classes.value).addClass(c.classes.input).dtDateTime({attachTo:"input",format:a.s.momentFormat?a.s.momentFormat:void 0}).on("input change",function(){b(a,this)}),e("<span>").addClass(a.classes.joiner).text("and"),e("<input/>").addClass(c.classes.value).addClass(c.classes.input).dtDateTime({attachTo:"input",
format:a.s.momentFormat?a.s.momentFormat:void 0}).on("input change",function(){b(a,this)})];null!==d&&0<d.length&&(e(f[0]).val(d[0]),e(f[2]).val(d[1]));return f};c.isInputValidSelect=function(a){for(var b=!0,d=0;d<a.length;d++){var f=a[d];e(f).children("option:selected").length===e(f).children("option").length-e(f).children("option."+c.classes.notItalic).length&&(1===e(f).children("option:selected").length&&e(f).children("option:selected")[0]===e(f).children("option:hidden")[0])&&(b=!1)}return b};
c.isInputValidInput=function(a){for(var b=!0,d=0;d<a.length;d++){var c=a[d];e(c).is("input")&&0===e(c).val().length&&(b=!1)}return b};c.inputValueSelect=function(a){for(var b=[],d=0;d<a.length;d++){var c=a[d];e(c).is("select")&&b.push(e(c).children("option:selected").val())}return b};c.inputValueInput=function(a){for(var b=[],d=0;d<a.length;d++){var c=a[d];e(c).is("input")&&b.push(e(c).val())}return b};c.updateListener=function(a,b){var d=a.s.conditions.get(a.s.condition);a.s.filled=d.isInputValid(a.dom.value,
a);a.s.value=d.inputValue(a.dom.value,a);Array.isArray(a.s.value)||(a.s.value=[a.s.value]);for(var c=d=null,g=0;g<a.dom.value.length;g++)b===a.dom.value[g][0]&&(d=g,void 0!==b.selectionStart&&(c=b.selectionStart));a.s.dt.draw();null!==d&&(e(a.dom.value[d]).removeClass(a.classes.italic),e(a.dom.value[d]).focus(),null!==c&&e(a.dom.value[d])[0].setSelectionRange(c,c))};c.dateConditions={"!=":{conditionName:"Not",init:c.initDate,inputValue:c.inputValueInput,isInputValid:c.isInputValidInput,search:function(a,
b){a=a.replace(/(\/|\-|\,)/g,"-");return a!==b[0]}},"!between":{conditionName:"Not Between",init:c.init2Date,inputValue:c.inputValueInput,isInputValid:c.isInputValidInput,search:function(a,b){a=a.replace(/(\/|\-|\,)/g,"-");return b[0]<b[1]?!(b[0]<=a&&a<=b[1]):!(b[1]<=a&&a<=b[0])}},"!null":{conditionName:"Not Empty",isInputValid:function(){return!0},init:function(){},inputValue:function(){},search:function(a){return!(null===a||void 0===a||0===a.length)}},"<":{conditionName:"Before",init:c.initDate,
inputValue:c.inputValueInput,isInputValid:c.isInputValidInput,search:function(a,b){a=a.replace(/(\/|\-|\,)/g,"-");return a<b[0]}},"=":{conditionName:"Equals",init:c.initDate,inputValue:c.inputValueInput,isInputValid:c.isInputValidInput,search:function(a,b){a=a.replace(/(\/|\-|\,)/g,"-");return a===b[0]}},">":{conditionName:"After",init:c.initDate,inputValue:c.inputValueInput,isInputValid:c.isInputValidInput,search:function(a,b){a=a.replace(/(\/|\-|\,)/g,"-");return a>b[0]}},between:{conditionName:"Between",
init:c.init2Date,inputValue:c.inputValueInput,isInputValid:c.isInputValidInput,search:function(a,b){a=a.replace(/(\/|\-|\,)/g,"-");return b[0]<b[1]?b[0]<=a&&a<=b[1]:b[1]<=a&&a<=b[0]}},"null":{conditionName:"Empty",isInputValid:function(){return!0},init:function(){},inputValue:function(){},search:function(a){return null===a||void 0===a||0===a.length}}};c.momentDateConditions={"!=":{conditionName:"Not",init:c.initDate,inputValue:c.inputValueInput,isInputValid:c.isInputValidInput,search:function(a,b,
d){return l(a,d.s.momentFormat).valueOf()!==l(b[0],d.s.momentFormat).valueOf()}},"!between":{conditionName:"Not Between",init:c.init2Date,inputValue:c.inputValueInput,isInputValid:c.isInputValidInput,search:function(a,b,d){var a=l(a,d.s.momentFormat).valueOf(),c=l(b[0],d.s.momentFormat).valueOf(),b=l(b[1],d.s.momentFormat).valueOf();return c<b?!(+c<=+a&&+a<=+b):!(+b<=+a&&+a<=+c)}},"!null":{conditionName:"Not Empty",isInputValid:function(){return!0},init:function(){},inputValue:function(){},search:function(a){return!(null===
a||void 0===a||0===a.length)}},"<":{conditionName:"Before",init:c.initDate,inputValue:c.inputValueInput,isInputValid:c.isInputValidInput,search:function(a,b,d){return l(a,d.s.momentFormat).valueOf()<l(b[0],d.s.momentFormat).valueOf()}},"=":{conditionName:"Equals",init:c.initDate,inputValue:c.inputValueInput,isInputValid:c.isInputValidInput,search:function(a,b,d){return l(a,d.s.momentFormat).valueOf()===l(b[0],d.s.momentFormat).valueOf()}},">":{conditionName:"After",init:c.initDate,inputValue:c.inputValueInput,
isInputValid:c.isInputValidInput,search:function(a,b,d){return l(a,d.s.momentFormat).valueOf()>l(b[0],d.s.momentFormat).valueOf()}},between:{conditionName:"Between",init:c.init2Date,inputValue:c.inputValueInput,isInputValid:c.isInputValidInput,search:function(a,b,d){var a=l(a,d.s.momentFormat).valueOf(),c=l(b[0],d.s.momentFormat).valueOf(),b=l(b[1],d.s.momentFormat).valueOf();return c<b?c<=a&&a<=b:b<=a&&a<=c}},"null":{conditionName:"Empty",isInputValid:function(){return!0},init:function(){},inputValue:function(){},
search:function(a){return null===a||void 0===a||0===a.length}}};c.numConditions={"!=":{conditionName:"Not",init:c.initSelect,inputValue:c.inputValueSelect,isInputValid:c.isInputValidSelect,search:function(a,b){return+a!==+b[0]}},"!between":{conditionName:"Not Between",init:c.init2Input,inputValue:c.inputValueInput,isInputValid:c.isInputValidInput,search:function(a,b){return+b[0]<+b[1]?!(+b[0]<=+a&&+a<=+b[1]):!(+b[1]<=+a&&+a<=+b[0])}},"!null":{conditionName:"Not Empty",isInputValid:function(){return!0},
init:function(){},inputValue:function(){},search:function(a){return!(null===a||void 0===a||0===a.length)}},"<":{conditionName:"Less Than",init:c.initInput,inputValue:c.inputValueInput,isInputValid:c.isInputValidInput,search:function(a,b){return+a<+b[0]}},"<=":{conditionName:"Less Than Equal To",init:c.initInput,inputValue:c.inputValueInput,isInputValid:c.isInputValidInput,search:function(a,b){return+a<=+b[0]}},"=":{conditionName:"Equals",init:c.initSelect,inputValue:c.inputValueSelect,isInputValid:c.isInputValidSelect,
search:function(a,b){return+a===+b[0]}},">":{conditionName:"Greater Than",init:c.initInput,inputValue:c.inputValueInput,isInputValid:c.isInputValidInput,search:function(a,b){return+a>+b[0]}},">=":{conditionName:"Greater Than Equal To",init:c.initInput,inputValue:c.inputValueInput,isInputValid:c.isInputValidInput,search:function(a,b){return+a>=+b[0]}},between:{conditionName:"Between",init:c.init2Input,inputValue:c.inputValueInput,isInputValid:c.isInputValidInput,search:function(a,b){return+b[0]<+b[1]?
+b[0]<=+a&&+a<=+b[1]:+b[1]<=+a&&+a<=+b[0]}},"null":{conditionName:"Empty",init:function(){},inputValue:function(){},isInputValid:function(){return!0},search:function(a){return null===a||void 0===a||0===a.length}}};c.numFmtConditions={"!=":{conditionName:"Not",init:c.initSelect,inputValue:c.inputValueSelect,isInputValid:c.isInputValidSelect,search:function(a,b){var d=a.replace(/[^0-9.]/g,""),c=b[0].replace(/[^0-9.]/g,"");return+d!==+c}},"!between":{conditionName:"Not Between",init:c.init2Input,inputValue:c.inputValueInput,
isInputValid:c.isInputValidInput,search:function(a,b){var d=a.replace(/[^0-9.]/g,""),c=b[0].replace(/[^0-9.]/g,""),e=b[1].replace(/[^0-9.]/g,"");return c<e?!(+c<=+d&&+d<=+e):!(+e<=+d&&+d<=+c)}},"!null":{conditionName:"Not Empty",isInputValid:function(){return!0},init:function(){},inputValue:function(){},search:function(a){return!(null===a||void 0===a||0===a.length)}},"<":{conditionName:"Less Than",init:c.initInput,inputValue:c.inputValueInput,isInputValid:c.isInputValidInput,search:function(a,b){var d=
a.replace(/[^0-9.]/g,""),c=b[0].replace(/[^0-9.]/g,"");return+d<+c}},"<=":{conditionName:"Less Than Equal To",init:c.initInput,inputValue:c.inputValueInput,isInputValid:c.isInputValidInput,search:function(a,b){var d=a.replace(/[^0-9.]/g,""),c=b[0].replace(/[^0-9.]/g,"");return+d<=+c}},"=":{conditionName:"Equals",init:c.initSelect,inputValue:c.inputValueSelect,isInputValid:c.isInputValidSelect,search:function(a,b){var d=a.replace(/[^0-9.]/g,""),c=b[0].replace(/[^0-9.]/g,"");return+d===+c}},">":{conditionName:"Greater Than",
init:c.initInput,inputValue:c.inputValueInput,isInputValid:c.isInputValidInput,search:function(a,b){var d=a.replace(/[^0-9.]/g,""),c=b[0].replace(/[^0-9.]/g,"");return+d>+c}},">=":{conditionName:"Greater Than Equal To",init:c.initInput,inputValue:c.inputValueInput,isInputValid:c.isInputValidInput,search:function(a,b){var d=a.replace(/[^0-9.]/g,""),c=b[0].replace(/[^0-9.]/g,"");return+d>=+c}},between:{conditionName:"Between",init:c.init2Input,inputValue:c.inputValueInput,isInputValid:c.isInputValidInput,
search:function(a,b){var d=a.replace(/[^0-9.]/g,""),c=b[0].replace(/[^0-9.]/g,""),e=b[1].replace(/[^0-9.]/g,"");return c<e?+c<=+d&&+d<=+e:+e<=+d&&+d<=+c}},"null":{conditionName:"Empty",init:function(){},inputValue:function(){},isInputValid:function(){return!0},search:function(a){return null===a||void 0===a||0===a.length}}};c.stringConditions={"!=":{conditionName:"Not",init:c.initSelect,inputValue:c.inputValueSelect,isInputValid:c.isInputValidInput,search:function(a,b){return a!==b[0]}},"!null":{conditionName:"Not Empty",
isInputValid:function(){return!0},init:function(){},inputValue:function(){},search:function(a){return!(null===a||void 0===a||0===a.length)}},"=":{conditionName:"Equals",init:c.initSelect,inputValue:c.inputValueSelect,isInputValid:c.isInputValidSelect,search:function(a,b){return a===b[0]}},contains:{conditionName:"Contains",init:c.initInput,inputValue:c.inputValueInput,isInputValid:c.isInputValidInput,search:function(a,b){return a.toLowerCase().includes(b[0].toLowerCase())}},ends:{conditionName:"Ends With",
init:c.initInput,inputValue:c.inputValueInput,isInputValid:c.isInputValidInput,search:function(a,b){return a.toLowerCase().indexOf(b[0].toLowerCase())===a.length-b[0].length}},"null":{conditionName:"Empty",init:function(){},inputValue:function(){},isInputValid:function(){return!0},search:function(a){return null===a||void 0===a||0===a.length}},starts:{conditionName:"Starts With",init:c.initInput,inputValue:c.inputValueInput,isInputValid:c.isInputValidInput,search:function(a,b){return 0===a.toLowerCase().indexOf(b[0].toLowerCase())}}};
c.defaults={columns:!0,conditions:{date:c.dateConditions,html:c.stringConditions,"html-num":c.numConditions,"html-num-fmt":c.numFmtConditions,moment:c.momentDateConditions,num:c.numConditions,"num-fmt":c.numFmtConditions,string:c.stringConditions},depthLimit:!1,greyscale:!1,orthogonal:{conditionName:"Condition Name",search:"filter"}};o=c;var g,v,s,j=function(a,b,d,c,e,i){void 0===c&&(c=0);void 0===e&&(e=!1);void 0===i&&(i=1);if(!v||!v.versionCheck||!v.versionCheck("1.10.0"))throw Error("SearchBuilder requires DataTables 1.10 or newer");
this.classes=g.extend(!0,{},j.classes);this.c=g.extend(!0,{},j.defaults,b);this.s={criteria:[],depth:i,dt:a,index:c,isChild:e,logic:void 0,opts:b,toDrop:void 0,topGroup:d};this.dom={add:g("<button/>").addClass(this.classes.add).addClass(this.classes.button),clear:g("<button>&times</button>").addClass(this.classes.button).addClass(this.classes.clearGroup),container:g("<div/>").addClass(this.classes.group),logic:g("<button/>").addClass(this.classes.logic).addClass(this.classes.button),logicContainer:g("<div/>").addClass(this.classes.logicContainer)};
void 0===this.s.topGroup&&(this.s.topGroup=this.dom.container);this._setup();return this};j.prototype.destroy=function(){g(this.dom.add).off(".dtsb");g(this.dom.logic).off(".dtsb");g(this.dom.container).trigger("dtsb-destroy").remove();this.s.criteria=[]};j.prototype.getDetails=function(){if(0===this.s.criteria.length)return{};for(var a={criteria:[],logic:this.s.logic},b=0,d=this.s.criteria;b<d.length;b++)a.criteria.push(d[b].criteria.getDetails());return a};j.prototype.getNode=function(){return this.dom.container};
j.prototype.rebuild=function(a){if(!(void 0===a.criteria||null===a.criteria||0===a.criteria.length)){this.s.logic=a.logic;g(this.dom.logic).text("OR"===this.s.logic?this.s.dt.i18n("searchBuilder.logicOr","Or"):this.s.dt.i18n("searchBuilder.logicAnd","And"));for(var b=0,d=a.criteria;b<d.length;b++)a=d[b],void 0!==a.logic?this._addPrevGroup(a):void 0===a.logic&&this._addPrevCriteria(a);b=0;for(d=this.s.criteria;b<d.length;b++)a=d[b],void 0===a.logic&&(a.criteria.updateArrows(1<this.s.criteria.length,
!1),this._setCriteriaListeners(a.criteria))}};j.prototype.redrawContents=function(){g(this.dom.container).empty().append(this.dom.logicContainer).append(this.dom.add);this.s.criteria.sort(function(a,d){return a.criteria.s.index<d.criteria.s.index?-1:a.criteria.s.index>d.criteria.s.index?1:0});this.setListeners();for(var a=0;a<this.s.criteria.length;a++)void 0===this.s.criteria[a].logic?(this.s.criteria[a].index=a,this.s.criteria[a].criteria.s.index=a,g(this.s.criteria[a].criteria.dom.container).insertBefore(this.dom.add),
this._setCriteriaListeners(this.s.criteria[a].criteria),this.s.criteria[a].criteria.rebuild(this.s.criteria[a].criteria.getDetails())):0<this.s.criteria[a].criteria.s.criteria.length?(this.s.criteria[a].index=a,this.s.criteria[a].criteria.s.index=a,g(this.s.criteria[a].criteria.dom.container).insertBefore(this.dom.add),this.s.criteria[a].criteria.redrawContents(),this._setGroupListeners(this.s.criteria[a].criteria)):(this.s.criteria.splice(a,1),a--);this.setupLogic()};j.prototype.search=function(a){return"AND"===
this.s.logic?this._andSearch(a):"OR"===this.s.logic?this._orSearch(a):!0};j.prototype.setupLogic=function(){g(this.dom.logicContainer).remove();g(this.dom.clear).remove();if(1>this.s.criteria.length)this.s.isChild||(g(this.dom.container).trigger("dtsb-destroy"),g(this.dom.container).css("margin-left",0));else{var a=g(this.dom.container).height()-2;g(this.dom.clear).height("0px");g(this.dom.logicContainer).append(this.dom.clear).width(a);g(this.dom.container).prepend(this.dom.logicContainer);this._setLogicListener();
g(this.dom.container).css("margin-left",g(this.dom.logicContainer).outerHeight(!0));var a=g(this.dom.logicContainer).offset(),b=a.left,d=g(this.dom.container).offset().left,b=b-(b-d)-g(this.dom.logicContainer).outerHeight(!0);g(this.dom.logicContainer).offset({left:b});b=g(this.dom.logicContainer).next();a=a.top;b=g(b).offset().top;a-=a-b;g(this.dom.logicContainer).offset({top:a});g(this.dom.clear).outerHeight(g(this.dom.logicContainer).height());this._setClearListener()}};j.prototype.setListeners=
function(){var a=this;g(this.dom.add).unbind("click");g(this.dom.add).on("click",function(){a.s.isChild||g(a.dom.container).prepend(a.dom.logicContainer);a.addCriteria();g(a.dom.container).trigger("dtsb-add");a.s.dt.state.save();return!1});for(var b=0,d=this.s.criteria;b<d.length;b++)d[b].criteria.setListeners();this._setClearListener();this._setLogicListener()};j.prototype.addCriteria=function(a,b){void 0===a&&(a=null);void 0===b&&(b=!0);var d=null===a?this.s.criteria.length:a.s.index,c=new o(this.s.dt,
this.s.opts,this.s.topGroup,d,this.s.depth);null!==a&&(c.c=a.c,c.s=a.s,c.s.depth=this.s.depth,c.classes=a.classes);c.populate();for(var e=!1,i=0;i<this.s.criteria.length;i++)0===i&&this.s.criteria[i].criteria.s.index>c.s.index?(g(c.getNode()).insertBefore(this.s.criteria[i].criteria.dom.container),e=!0):i<this.s.criteria.length-1&&(this.s.criteria[i].criteria.s.index<c.s.index&&this.s.criteria[i+1].criteria.s.index>c.s.index)&&(g(c.getNode()).insertAfter(this.s.criteria[i].criteria.dom.container),
e=!0);e||g(c.getNode()).insertBefore(this.dom.add);this.s.criteria.push({criteria:c,index:d});this.s.criteria=this.s.criteria.sort(function(a,b){return a.criteria.s.index-b.criteria.s.index});d=0;for(e=this.s.criteria;d<e.length;d++)i=e[d],void 0===i.logic&&i.criteria.updateArrows(1<this.s.criteria.length,b);this._setCriteriaListeners(c);c.setListeners();this.setupLogic()};j.prototype.checkFilled=function(){for(var a=0,b=this.s.criteria;a<b.length;a++){var d=b[a];if(void 0===d.logic&&d.criteria.s.filled||
void 0!==d.logic&&d.criteria.checkFilled())return!0}return!1};j.prototype.count=function(){for(var a=0,b=0,d=this.s.criteria;b<d.length;b++){var c=d[b];void 0!==c.logic?a+=c.criteria.count():a++}return a};j.prototype._addPrevGroup=function(a){var b=this.s.criteria.length,d=new j(this.s.dt,this.c,this.s.topGroup,b,!0,this.s.depth+1);this.s.criteria.push({criteria:d,index:b,logic:d.s.logic});d.rebuild(a);this.s.criteria[b].criteria=d;g(this.s.topGroup).trigger("dtsb-redrawContents");this._setGroupListeners(d)};
j.prototype._addPrevCriteria=function(a){var b=this.s.criteria.length,d=new o(this.s.dt,this.s.opts,this.s.topGroup,b,this.s.depth);d.populate();this.s.criteria.push({criteria:d,index:b});d.rebuild(a);this.s.criteria[b].criteria=d;g(this.s.topGroup).trigger("dtsb-redrawContents")};j.prototype._andSearch=function(a){if(0===this.s.criteria.length)return!0;for(var b=0,d=this.s.criteria;b<d.length;b++){var c=d[b];if((void 0!==c.logic||c.criteria.s.filled)&&!c.criteria.search(a))return!1}return!0};j.prototype._orSearch=
function(a){if(0===this.s.criteria.length)return!0;for(var b=!1,d=0,c=this.s.criteria;d<c.length;d++){var e=c[d];if(e.criteria.s.filled){if(b=!0,e.criteria.search(a))return!0}else if(void 0!==e.logic&&e.criteria.checkFilled()&&(b=!0,e.criteria.search(a)))return!0}return!b};j.prototype._removeCriteria=function(a,b){void 0===b&&(b=!1);if(1>=this.s.criteria.length&&this.s.isChild)this.destroy();else{for(var d=void 0,c=0;c<this.s.criteria.length;c++)if(this.s.criteria[c].index===a.s.index&&(!b||this.s.criteria[c].criteria instanceof
j))d=c;void 0!==d&&this.s.criteria.splice(d,1);for(c=0;c<this.s.criteria.length;c++)this.s.criteria[c].index=c,this.s.criteria[c].criteria.s.index=c}};j.prototype._setCriteriaListeners=function(a){var b=this;g(a.dom["delete"]).unbind("click").on("click",function(){b._removeCriteria(a);g(a.dom.container).remove();b.setupLogic();for(var c=0,e=b.s.criteria;c<e.length;c++){var h=e[c];void 0===h.logic&&h.criteria.updateArrows(1<b.s.criteria.length)}a.destroy();b.s.dt.draw();g(b.s.topGroup).trigger("dtsb-updateTitle");
return!1});g(a.dom.right).unbind("click").on("click",function(){var c=a.s.index,e=new j(b.s.dt,b.s.opts,b.s.topGroup,a.s.index,!0,b.s.depth+1);e.addCriteria(a);b.s.criteria[c].criteria=e;b.s.criteria[c].logic="AND";g(b.s.topGroup).trigger("dtsb-redrawContents");b._setGroupListeners(e);return!1});g(a.dom.left).unbind("click").on("click",function(){b.s.toDrop=new o(b.s.dt,b.s.opts,b.s.topGroup,a.s.index);b.s.toDrop.s=a.s;b.s.toDrop.c=a.c;b.s.toDrop.classes=a.classes;b.s.toDrop.populate();var c=b.s.toDrop.s.index;
g(b.dom.container).trigger("dtsb-dropCriteria");a.s.index=c;b._removeCriteria(a);g(b.s.topGroup).trigger("dtsb-redrawContents");b.s.dt.draw();return!1})};j.prototype._setClearListener=function(){var a=this;g(this.dom.clear).unbind("click").on("click",function(){if(!a.s.isChild)return g(a.dom.container).trigger("dtsb-clearContents"),!1;a.destroy();g(a.s.topGroup).trigger("dtsb-updateTitle");g(a.s.topGroup).trigger("dtsb-redrawContents");return!1})};j.prototype._setGroupListeners=function(a){var b=
this;g(a.dom.add).unbind("click").on("click",function(){b.setupLogic();g(b.dom.container).trigger("dtsb-add");return!1});g(a.dom.container).unbind("dtsb-add").on("dtsb-add",function(){b.setupLogic();g(b.dom.container).trigger("dtsb-add");return!1});g(a.dom.container).unbind("dtsb-destroy").on("dtsb-destroy",function(){b._removeCriteria(a,!0);g(a.dom.container).remove();b.setupLogic();return!1});g(a.dom.container).unbind("dtsb-dropCriteria").on("dtsb-dropCriteria",function(){var c=a.s.toDrop;c.s.index=
a.s.index;c.updateArrows(1<b.s.criteria.length,!1);b.addCriteria(c,!1);return!1});a.setListeners()};j.prototype._setup=function(){this.setListeners();g(this.dom.add).text(this.s.dt.i18n("searchBuilder.add","Add Condition"));g(this.dom.logic).text("OR"===this.c.logic?this.s.dt.i18n("searchBuilder.logicOr","Or"):this.s.dt.i18n("searchBuilder.logicAnd","And"));this.s.logic="OR"===this.c.logic?"OR":"AND";this.c.greyscale&&g(this.dom.logic).addClass(this.classes.greyscale);g(this.dom.logicContainer).append(this.dom.logic).append(this.dom.clear);
this.s.isChild&&g(this.dom.container).append(this.dom.logicContainer);g(this.dom.container).append(this.dom.add)};j.prototype._setLogicListener=function(){var a=this;g(this.dom.logic).unbind("click").on("click",function(){a._toggleLogic();a.s.dt.draw();for(var b=0,c=a.s.criteria;b<c.length;b++)c[b].criteria.setListeners()})};j.prototype._toggleLogic=function(){"OR"===this.s.logic?(this.s.logic="AND",g(this.dom.logic).text(this.s.dt.i18n("searchBuilder.logicAnd","And"))):"AND"===this.s.logic&&(this.s.logic=
"OR",g(this.dom.logic).text(this.s.dt.i18n("searchBuilder.logicOr","Or")))};j.version="0.0.1";j.classes={add:"dtsb-add",button:"dtsb-button",clearGroup:"dtsb-clearGroup",greyscale:"dtsb-greyscale",group:"dtsb-group",inputButton:"dtsb-iptbtn",logic:"dtsb-logic",logicContainer:"dtsb-logicContainer"};j.defaults={depthLimit:!1,greyscale:!1,logic:"AND"};s=j;var h,t,w,m=function(a,b){var c=this;if(!t||!t.versionCheck||!t.versionCheck("1.10.0"))throw Error("SearchBuilder requires DataTables 1.10 or newer");
var e=new t.Api(a);this.classes=h.extend(!0,{},m.classes);this.c=h.extend(!0,{},m.defaults,b);this.dom={clearAll:h('<button type="button">'+e.i18n("searchBuilder.clearAll","Clear All")+"</button>").addClass(this.classes.clearAll).addClass(this.classes.button),container:h("<div/>").addClass(this.classes.container),title:h("<div/>").addClass(this.classes.title),titleRow:h("<div/>").addClass(this.classes.titleRow),topGroup:void 0};this.s={dt:e,opts:b,search:void 0,topGroup:void 0};if(void 0===e.settings()[0]._searchBuilder){e.settings()[0]._searchBuilder=
this;if(this.s.dt.settings()[0]._bInitComplete)this._setUp();else e.one("init.dt",function(){c._setUp()});return this}};m.prototype.getDetails=function(){return this.s.topGroup.getDetails()};m.prototype.getNode=function(){return this.dom.container};m.prototype.rebuild=function(a){h(this.dom.clearAll).click();if(void 0===a||null===a)return this;this.s.topGroup.rebuild(a);this.s.dt.draw();this.s.topGroup.setListeners();return this};m.prototype._applyPreDefDefaults=function(a){var b=this;void 0!==a.criteria&&
void 0===a.logic&&(a.logic="AND");for(var c=function(a){a.criteria!==void 0?a=e._applyPreDefDefaults(a):e.s.dt.columns().every(function(c){if(b.s.dt.settings()[0].aoColumns[c].sTitle===a.data)a.dataIdx=c})},e=this,g=0,i=a.criteria;g<i.length;g++)c(i[g]);return a};m.prototype._setUp=function(a){var b=this;void 0===a&&(a=!0);this.s.topGroup=new s(this.s.dt,this.c,void 0);this._setClearListener();this.s.dt.on("stateSaveParams",function(a,c,e){e.searchBuilder=b.getDetails();e.page=b.s.dt.page()});this._build();
a&&(a=this.s.dt.state.loaded(),null!==a&&void 0!==a.searchBuilder?(this.s.topGroup.rebuild(a.searchBuilder),h(this.s.topGroup.dom.container).trigger("dtsb-redrawContents"),this.s.dt.page(a.page).draw("page"),this.s.topGroup.setListeners()):!1!==this.c.preDefined&&(this.c.preDefined=this._applyPreDefDefaults(this.c.preDefined),this.rebuild(this.c.preDefined)));this._setEmptyListener();this.s.dt.state.save()};m.prototype._updateTitle=function(a){h(this.dom.title).text(this.s.dt.i18n("searchBuilder.title",
{"0":"Custom Search Builder",_:"Custom Search Builder (%d)"},a))};m.prototype._build=function(){var a=this;h(this.dom.clearAll).remove();h(this.dom.container).empty();var b=this.s.topGroup.count();this._updateTitle(b);h(this.dom.titleRow).append(this.dom.title);h(this.dom.container).append(this.dom.titleRow);this.dom.topGroup=this.s.topGroup.getNode();h(this.dom.container).append(this.dom.topGroup);this._setRedrawListener();var c=this.s.dt.table(0).node();-1===h.fn.dataTable.ext.search.indexOf(this.s.search)&&
(this.s.search=function(b,e){return b.nTable!==c?!0:a.s.topGroup.search(e)},h.fn.dataTable.ext.search.push(this.s.search));h.fn.DataTable.Api.registerPlural("columns().type()","column().type()",function(){return this.iterator("column",function(a,b){return a.aoColumns[b].sType},1)});this.s.dt.on("destroy.dt",function(){h(a.dom.container).remove();h(a.dom.clearAll).remove();for(var b=h.fn.dataTable.ext.search.indexOf(a.s.search);b!==-1;){h.fn.dataTable.ext.search.splice(b,1);b=h.fn.dataTable.ext.search.indexOf(a.s.search)}})};
m.prototype._checkClear=function(){0<this.s.topGroup.s.criteria.length?(h(this.dom.clearAll).insertAfter(this.dom.title),this._setClearListener()):h(this.dom.clearAll).remove()};m.prototype._setClearListener=function(){var a=this;h(this.dom.clearAll).unbind("click");h(this.dom.clearAll).on("click",function(){a.s.topGroup=new s(a.s.dt,a.s.opts,void 0);a._build();a.s.dt.draw();a.s.topGroup.setListeners();h(a.dom.clearAll).remove();a._setEmptyListener();void 0!==a.c.filterChanged&&"function"===typeof a.c.filterChanged&&
a.c.filterChanged(0);return!1})};m.prototype._setRedrawListener=function(){var a=this;h(this.s.topGroup.dom.container).unbind("dtsb-redrawContents");h(this.s.topGroup.dom.container).on("dtsb-redrawContents",function(){a._checkClear();a.s.topGroup.redrawContents();a.s.topGroup.setupLogic();a._setEmptyListener();var b=a.s.topGroup.count();a._updateTitle(b);void 0!==a.c.filterChanged&&"function"===typeof a.c.filterChanged&&a.c.filterChanged(b);a.s.dt.state.save()});h(this.s.topGroup.dom.container).unbind("dtsb-clearContents");
h(this.s.topGroup.dom.container).on("dtsb-clearContents",function(){a._setUp(!1);void 0!==a.c.filterChanged&&"function"===typeof a.c.filterChanged&&a.c.filterChanged(0);a.s.dt.draw()});h(this.s.topGroup.dom.container).on("dtsb-updateTitle",function(){var b=a.s.topGroup.count();a._updateTitle(b);void 0!==a.c.filterChanged&&"function"===typeof a.c.filterChanged&&a.c.filterChanged(b)})};m.prototype._setEmptyListener=function(){var a=this;h(this.s.topGroup.dom.add).on("click",function(){a._checkClear()});
h(this.s.topGroup.dom.container).on("dtsb-destroy",function(){h(a.dom.clearAll).remove()})};m.version="0.0.1";m.classes={button:"dtsb-button",clearAll:"dtsb-clearAll",container:"dtsb-searchBuilder",inputButton:"dtsb-iptbtn",title:"dtsb-title",titleRow:"dtsb-titleRow"};m.defaults={filterChanged:void 0,preDefined:!1};w=m;var z=function(a,b,c){function f(a){var a=new j.Api(a),b=a.init().searchBuilder||j.defaults.searchBuilder;return(new w(a,b)).getNode()}h=a;t=a.fn.DataTable;g=a;v=a.fn.dataTable;e=a;
var j=r=a.fn.dataTable;a.fn.dataTable.SearchBuilder=w;a.fn.DataTable.SearchBuilder=w;a.fn.dataTable.Group=s;a.fn.DataTable.Group=s;a.fn.dataTable.Criteria=o;a.fn.DataTable.Criteria=o;b=a.fn.dataTable.Api.register;a.fn.dataTable.ext.searchBuilder={conditions:{}};a.fn.dataTable.ext.buttons.searchBuilder={action:function(a,b,c,d){a.stopPropagation();this.popover(d._searchBuilder.getNode(),{align:"dt-container"})},config:{},init:function(b,c,d){var e=new a.fn.dataTable.SearchBuilder(b,a.extend({filterChanged:function(a){b.button(c).text(b.i18n("searchBuilder.button",
{"0":"Search Builder",_:"Search Builder (%d)"},a))}},d.config)),f=b.i18n("searchBuilder.button","Search Builder",0);b.button(c).text(f);d._searchBuilder=e},text:"Search Builder"};b("searchBuilder.getDetails()",function(){return this.context[0]._searchBuilder.getDetails()});b("searchBuilder.rebuild()",function(a){this.context[0]._searchBuilder.rebuild(a);return this});b("searchBuilder.container()",function(){return this.context[0]._searchBuilder.getNode()});a(c).on("preInit.dt.dtsp",function(a,b){if("dt"===
a.namespace&&(b.oInit.searchBuilder||j.defaults.searchBuilder))b._searchBuilder||f(b)});j.ext.feature.push({cFeature:"Q",fnInit:f});j.ext.features&&j.ext.features.register("searchBuilder",f)};"function"===typeof define&&define.amd?define(["jquery","datatables.net"],function(a){return z(a,window,document)}):"object"===typeof exports?module.exports=function(a,b){a||(a=window);if(!b||!b.fn.dataTable)b=require("datatables.net")(a,b).$;return z(b,a,a.document)}:z(window.jQuery,window,document)})();
